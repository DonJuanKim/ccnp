<div class="container">
  <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
    <% if @capsule.photos.any? %>
      <div class="carousel-inner">
        <% @capsule.photos.each_with_index do |photo, index| %>
          <% if index == 0 %>
            <div class="carousel-item active">
              <%= cl_image_tag photo.key %>
            </div>
          <% else %>
            <div class="carousel-item">
              <%= cl_image_tag photo.key %>
            </div>
          <% end %>
        <% end %>
      </div>
    <% else %>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <%= image_tag "capsules_default_display.jpg", crop: :fill %>
        </div>
      </div>
    <% end %>
    <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>

  <h2><%= "#{@capsule.name}" %></h2>
  <p class="font-italic"><%= "#{@capsule.description}" %></p>
  <p><%= "# #{@capsule.number}" %></p>
  <p><%= " #{@capsule.price}$" %></p>
  <p><%= "From: #{@capsule.user.first_name} #{@capsule.user.last_name}"%></p>
  <p><%= "Added on: #{@capsule.created_at}" %></p>

  <% if @capsule.user == current_user %>
    <br>
    <% if @capsule.user == current_user %>
      <div data-controller="edit-form">
        <button data-action="click->edit-form#toggleEdit" id="edit-btn" class="btn btn-primary btn-lg">
          Edit
        </button>
        <%= link_to 'Delete', capsule_path(@capsule), class: "btn btn-danger btn-lg", data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this capsule?" } %>
        <br>
        <%= simple_form_for(@capsule, html: {data: {"edit-form-target": "editForm"}, class: "d-none"}) do |f| %>
          <%= f.input :name %>
          <%= f.input :description %>
          <%= f.input :price %>
          <%= f.input :number %>

          <%= f.input :photos, as: :file, input_html: { multiple: true } %>
          <%= f.button :submit, "Submit" %>

        <% end %>
      </div>
    <% end %>
  <% else %>
    <%= simple_form_for([@capsule, @booking]) do |f| %>
      <%= f.input :period_start, as: :date %>
      <%= f.input :period_end, as: :date  %>

      <%= f.button :submit, "Submit" %>
    <% end %>
  <% end %>

</div>
